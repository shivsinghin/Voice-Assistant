<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lisa - Personal Voice Agent</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        .animation-delay-100 { animation-delay: 0.1s; }
        .animation-delay-200 { animation-delay: 0.2s; }
        .animation-delay-300 { animation-delay: 0.3s; }
        .animation-delay-400 { animation-delay: 0.4s; }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fadeInUp {
            animation: fadeInUp 0.5s ease-out;
        }

        .transition-optimized {
            will-change: transform, opacity;
            transform: translateZ(0);
        }
    </style>
</head>
<body class="min-h-screen bg-black text-white overflow-hidden">
    <!-- Error Display -->
    <div id="error-display" class="hidden fixed top-4 left-4 right-4 sm:left-6 sm:right-6 p-3 sm:p-4 bg-red-500/20 border border-red-500/30 text-red-200 rounded-lg backdrop-blur-sm z-50 text-sm sm:text-base animate-fadeInUp">
    </div>

    <!-- Login Modal -->
    <div id="login-modal" class="fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50">
        <div class="bg-stone-900/90 border border-stone-800 rounded-2xl p-8 w-full max-w-md mx-4 animate-fadeInUp">
            <h2 class="text-xl font-normal text-white mb-6 text-center">Enter your email and password for accessing Lisa.</h2>
            
            <form id="login-form" class="space-y-4">
                <div>
                    <label for="username" class="block text-white/80 text-md font-normal mb-2">Username</label>
                    <input 
                        type="text" 
                        id="username" 
                        name="username" 
                        required
                        class="w-full px-3 py-3 bg-stone-900 border-2 border-stone-800 rounded-lg text-white focus:outline-none focus:ring-1 focus:ring-gray-800 focus:border-transparent transition-colors"
                        autocomplete="username"
                    >
                </div>
                
                <div class="mb-6">
                    <label for="password" class="block text-white/80 text-md font-normal mb-2">Password</label>
                    <input 
                        type="password" 
                        id="password" 
                        name="password" 
                        required
                        class="w-full px-3 py-3 bg-stone-900 border-2 border-stone-800 rounded-lg text-white focus:outline-none focus:ring-1 focus:ring-gray-800 focus:border-transparent transition-colors"
                        autocomplete="current-password"
                    >
                </div>
                
                <button 
                    type="submit" 
                    id="login-btn"
                    class="w-full bg-white text-lg hover:bg-stone-200 text-black font-medium py-3 px-4 rounded-lg transition-colors duration-200 focus:outline-none focus:ring-1 focus:ring-gray-800 focus:ring-offset-2 focus:ring-offset-stone-900 disabled:opacity-50 disabled:cursor-not-allowed"
                >
                    <span id="login-btn-text">LOGIN</span>
                    <span id="login-spinner" class="hidden">
                        <i data-lucide="loader-2" class="w-4 h-4 animate-spin inline-block mr-2"></i>
                        Verifying...
                    </span>
                </button>
            </form>
            
            <div id="login-error" class="hidden mt-4 p-3 bg-red-500/20 border border-red-500/30 text-red-200 rounded-lg text-sm text-center animate-fadeInUp">
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="main-app" class="hidden min-h-screen flex flex-col items-center justify-center relative px-4 sm:px-6 lg:px-8">
        
        <!-- Header Controls -->
        <div class="absolute top-4 left-4 right-4 flex justify-between items-center">
            <!-- Connection Status Indicator -->
            <div id="connection-indicator" class="w-2 h-2 rounded-full bg-red-700 shadow-lg transition-all duration-300"></div>
            
            <!-- Logout Button -->
            <button id="logout-btn" class="pb-1 px-3 py-0.5 bg-black border-2 border-stone-900 hover:bg-stone-900 text-stone-700 rounded-lg transition-colors duration-200 text-md">
                Logout
            </button>
        </div>
        
        <!-- Main Content Area -->
        <div class="flex flex-col items-center justify-center flex-1 w-full max-w-4xl mx-auto">
            
            <!-- Voice Interface Button -->
            <div class="mb-8 sm:mb-12 md:mb-16">
                <button id="connect-btn" class="relative focus:outline-none group disabled:cursor-not-allowed transition-optimized">
                    <!-- Main Container -->
                    <div id="main-container" class="relative w-24 h-24 sm:w-28 sm:h-28 md:w-32 md:h-32 lg:w-36 lg:h-36 rounded-full transition-all duration-500 cursor-pointer overflow-hidden bg-stone-700 hover:bg-stone-800 border border-stone-700 shadow-2xl">
                        
                        <!-- Speaking Animation Rings -->
                        <div id="speaking-rings" class="hidden">
                            <div class="absolute inset-0 rounded-full bg-purple-400/20 animate-ping opacity-60"></div>
                            <div class="absolute inset-2 rounded-full bg-purple-300/30 animate-ping opacity-70 animation-delay-200"></div>
                            <div class="absolute inset-4 rounded-full bg-purple-200/40 animate-ping opacity-80 animation-delay-400"></div>
                        </div>
                        
                        <!-- Listening Animation Rings -->
                        <div id="listening-rings" class="hidden">
                            <div class="absolute inset-0 rounded-full bg-blue-400/20 animate-pulse opacity-50"></div>
                            <div class="absolute inset-3 rounded-full bg-blue-300/30 animate-pulse opacity-70 animation-delay-300"></div>
                        </div>
                        
                        <!-- Icons Container -->
                        <div class="absolute inset-0 flex items-center justify-center z-10">
                            <!-- Disconnected Icon -->
                            <div id="icon-disconnected" class="flex items-center justify-center">
                                <i data-lucide="mic-off" class="w-6 h-6 text-white/70"></i>
                            </div>
                            
                            <!-- Idle Icon -->
                            <div id="icon-idle" class="hidden flex items-center justify-center">
                                <i data-lucide="mic" class="w-6 h-6 text-white"></i>
                            </div>
                            
                            <!-- Listening Icon -->
                            <div id="icon-listening" class="hidden flex items-center space-x-1">
                                <div class="w-1 h-6 bg-white rounded animate-pulse"></div>
                                <div class="w-1 h-6 bg-white rounded animate-pulse animation-delay-100"></div>
                                <div class="w-1 h-6 bg-white rounded animate-pulse animation-delay-200"></div>
                                <div class="w-1 h-6 bg-white rounded animate-pulse animation-delay-300"></div>
                                <div class="w-1 h-6 bg-white rounded animate-pulse animation-delay-400"></div>
                            </div>
                            
                            <!-- Speaking Icon -->
                            <div id="icon-speaking" class="hidden flex items-center justify-center">
                                <i data-lucide="volume-2" class="w-6 h-6 text-white animate-pulse"></i>
                            </div>
                            
                            <!-- Connecting Icon -->
                            <div id="icon-connecting" class="hidden flex items-center justify-center">
                                <i data-lucide="waves" class="w-6 h-6 text-white animate-pulse"></i>
                            </div>
                        </div>
                    </div>
                </button>
            </div>

            <!-- Live Transcription Display -->
            <div id="live-transcript" class="hidden w-full max-w-3xl mx-auto px-4 sm:px-6">
                <div class="text-center animate-fadeInUp">
                    <div id="live-transcript-text" class="text-xl sm:text-2xl md:text-3xl font-light leading-relaxed break-words mb-3">
                    </div>
                    <div id="live-speaker-indicator" class="text-sm sm:text-base font-medium opacity-60">
                    </div>
                </div>
            </div>

            <!-- Status Messages -->
            <div id="status-area" class="text-center">
                <!-- Initial Connect Message -->
                <div id="initial-message" class="text-center text-white/60 max-w-md px-4">
                </div>

                <!-- Connecting Message -->
                <div id="connecting-message" class="hidden text-center text-white/80 max-w-md px-4">
                </div>

                <!-- Status Messages for Connected State -->
                <div id="connected-status" class="hidden text-center text-white/60 max-w-md px-4">
                    <p id="status-text" class="text-base sm:text-lg font-light">
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Hidden Audio Element for WebRTC -->
    <audio id="audio-el" autoplay style="display: none;"></audio>
    
    <!-- Optimized Script Loading -->
    <script src="/static/script.js"></script>
</body>
</html>